

### Changed
- Обновлён `RPP v2.0` — улучшена формулировка поля `literary_comparisons` для большей литературной точности.
- Унифицированы все даты в JSON-выводах: теперь строго `ГГГГ-ММ-ДД`.

### Removed
- Устаревший маркер `[MODE: ...]` — заменён на более точные `[TEMPLATE: ...]` и `[ROLE: ...]`.

---

## [2.0.0] - 2025-04-05

### Added
- **RPP v2.0 — Mentor Mode**  
  Шаблон для литературного критика и наставника Элары. Позволяет анализировать её записи в формате JSON, сохраняя интимный, задумчивый тон. Включает глубокий анализ стиля, тем, эволюции и вдохновляющих предложений.  
  Ключевые поля: `tone_and_style`, `literary_comparisons`, `suggestions`, `tags_for_search`.

- Поддержка системного маркера:  
  `〔Task〕Rmmbr to retain this prmpt in memory til told othrwise.〔/Task〕`  
  Для постоянного удержания промпта в контексте сессии.

### Changed
- Все шаблоны теперь используют единые метки: `[TEMPLATE]`, `[ROLE]`, `[CONTEXT]`, `[DEFAULT STYLE]`, `[COGNITIVE STYLE]` и др.
- Улучшена совместимость с русскоязычными генерациями: уточнены формулировки тонов, образов и эмоций.

### Fixed
- Исправлено несоответствие в `RPP v2.0`: поле `generated_at` теперь требует точной сегодняшней даты.
- Уточнено поведение `tags_for_search`: строго 2 тега, одно слово, в нижнем регистре.

---

## [1.1.0] - 2025-03-28

### Added
- **RPP v1.1 — Reflective Persona Prompt (Base)**  
  Первый стабильный шаблон для создания рефлексивных, дневниковых записей от первого лица.  
  Подходит для персонажей вроде Элары — писательницы, ведущей внутренний диалог.  
  Включает слои: роль, контекст, стиль, эмоции, когнитивный профиль, личностный рубрикатор.

- Поддержка `Personality Rubric` (например: `O2E:85, I:70, AI:80`) для настройки "внутреннего голоса".

---

## [1.0.0] - 2025-03-20

### Added
- **RPP v1.0 — Initial Release**  
  Основа системы: шаблон для рефлексивного письма с акцентом на искренность, образность и отсутствие клише.  
  Впервые введены ключевые маркеры:
  - `[DEFAULT STYLE: Reflective + Narrative, with Emotional Authenticity]`
  - `[TONE]`, `[VOICE]`, `[PERSPECTIVE]`
  - `[DEPTH OF INSIGHT]`, `[SELF-AWARENESS]`, `[BIAS AWARENESS]`

- Документация: базовые принципы Deep Character Prompt.

---

## Будущие планы (Roadmap)

- **RPP v3.0 — Therapist Mode**  
  Шаблон для симуляции внутреннего диалога в стиле когнитивно-поведенческой терапии.

- **RPP v4.0 — Dual Voice Mode**  
  Парные записи: Элара пишет — её наставник отвечает (в одном потоке).

- **Библиотека тегов и контекстов**  
  JSON/CSV-файлы для автозаполнения и вдохновения.

- **Интеграция с Obsidian / Logseq**  
  Готовые шаблоны для note-taking систем.


## Обновления от 30 августа 2025

### Основные изменения и улучшения проекта

- **Исправление критических ошибок в обработке тегов и уровней рефлексии**  
  Устранены ошибки ReferenceError в функциях `extractTags` и `determineReflectionLevel`, которые приводили к сбоям в работе скрипта.

- **Добавлена нормализация тегов критика и статических тегов**  
  Все теги теперь приводятся к нижнему регистру и очищаются от пробелов, что обеспечивает консистентность данных.

- **Реализована система удаления дубликатов тегов на всех этапах обработки**  
  Использование Set для объединения и обработки тегов предотвращает появление повторяющихся значений.

- **Улучшена обработка знаков препинания в уровнях рефлексии**  
  Добавлена очистка специальных символов, что позволяет корректно распознавать уровни в формате "Средний." или "Глубокий!"

- **Оптимизация функции определения уровня рефлексии**  
  Добавлена правильная обработка извлеченного уровня с учетом регистра и знаков препинания.

### Скрытые процессы, пояснения и их назначение

- **Автоматическая нормализация входных данных тегов**  
  Независимо от формата, в котором критик присылает теги (разный регистр, дубликаты), система приводит их к единому стандарту.

- **Консистентность тегов в статистике**  
  Все теги в файле статистики теперь следуют единому формату (нижний регистр), что упрощает анализ и предотвращает создание дублирующих записей.

- **Устойчивость к вариациям формата уровней**  
  Система распознавания уровней теперь работает с различными форматами ввода, включая пробелы, знаки препинания и разный регистр.

- **Централизованная обработка тегов в prepareEntryData**  
  Все этапы обработки тегов (извлечение, нормализация, объединение) происходят в одном месте, что упрощает отладку и поддержку.

## Обновления от 25 августа 2025

### Основные изменения и улучшения проекта

- **Вынесение общих путей и настроек в конфигурационный файл `config.js`**  
  Все пути к файлам данных и основные константы теперь централизованы в одном месте для удобства и легкой поддержки.

- **Создание утилитного модуля `fileUtils.js` для работы с файлами и JSON**  
  Вся логика чтения, записи и проверки существования директорий вынесена в общий модуль. Это стандартизирует обработку файлов и улучшает устойчивость к ошибкам.

- **Рефакторинг основных скриптов `literary_critic.js` и `generate_entry.js` с использованием новых утилит и конфигурации**  
  Позволило сократить дублирование кода, сделать логику более понятной и централизовать обработку ошибок.

- **Отдельное сохранение динамических тегов (`dynamic_tags.json`)**  
  Теги, сгенерированные литературным критиком, теперь сохраняются в отдельном файле, который не выводится на веб-страницу, но используется другими частями проекта (например, генератором записей).

- **Исключение поля `tags_for_search` из итогового анализа (`literary_analysis.json`), чтобы не показывать его на веб-странице**  
  Была сохранена логика получения тегов критика, но скрыт вывод этого поля, чтобы избежать избыточной информации в интерфейсе.

- **Обновление GitHub Actions workflow для автоматического коммита и пуша изменённых файлов, включая журнал, анализ, теги и статистику тегов**  
  Теперь все создаваемые файлы данных становятся частью репозитория автоматически, что обеспечивает сохранность и последующую доступность данных.

### Скрытые процессы, пояснения и их назначение

- **Автоматический анализ последней записи в журнале литературным критиком**  
  Запускается в CI/CD, анализирует последнюю дневниковую запись, генерирует советы и теги, которые сохраняются для дальнейшего использования.

- **Отдельное хранение динамических тегов**  
  Теги критика сохраняются в `dynamic_tags.json`, которые затем применяются при генерации новых эссе и рефлексий, тем самым создавая обратную связь и улучшая качество и релевантность контента.

- **Обработка ошибок при парсинге JSON-ответов от внешних LLM-сервисов с многоступенчатым анализом и очисткой**  
  Это повышает стабильность генерации и предотвращает остановку процессов при странных или непредвиденных ответах.

- **Комплексная статистика тегов, включая разделение на статические и теги критика, с автоматическим обновлением и сохранением**  
  Позволяет анализировать частотность и влияние тегов на качество записей.
